Есть таблица курсов валют ЦБ, состоящая из трех полей: 
CODE [ISO код валюты],  
RATE [Значение курса], 
VALUE_DAY [Дата начала действия курса]. 
Данные в нее записываются каждый раз при изменении курса какой-либо валюты. (Обратите внимание не каждый день, а в день, когда ЦБ поменял курс) 
Задача: получить курс валюты «USD» на заданную (любую) дату.
-- Создаем таблицу CB_RATES курсов валют ЦБ, состоящую из трех полей: 
CREATE TABLE CB_RATES (
    CODE VARCHAR(3),
    RATE NUMERIC(10, 4),
    VALUE_DAY DATE
);

-- Заполняем таблицу CB_RATES данными
INSERT INTO CB_RATES (CODE, RATE, VALUE_DAY)
VALUES
    ('USD', 1.2345, '2024-02-01'),
    ('USD', 12.345, '2024-02-02');

-- Запрос на получение курс валюты «USD» на заданную дату.
SELECT RATE
FROM CB_RATES
WHERE CODE = 'USD' AND VALUE_DAY = '2024-02-02';
