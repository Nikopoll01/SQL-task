На входе у нас небольшой набор данных, имитирующий продажи одной номенклатуры по нескольким складам компании. Поля источника данных – Склад, Дата, СуммаПродаж.
На конкретном Складе эта определенная номенклатура продается не каждый день.
На основе этих исходных данных в любой SQL базе данных надо построить модель, которая позволит получать отчет по дням со следующими столбцами: 
Склад	Дата	Продажи, тыс.руб.	Продажи за аналогичный период предыдущего года, тыс.руб.	Продажи за аналогичный период предыдущего месяца
И отчет по месяцам со следующими столбцами:
Склад	Год	Месяц	Продажи, тыс.руб.	Продажи за аналогичный период предыдущего года, тыс.руб.	Продажи за аналогичный период предыдущего месяца

Для этого задания принципиально не умножать объем исходных данных.  То есть мы не можем просто добавить в таблицу пред-рассчитанные поля для продаж прошлого года и прошлого месяца (исходим из того, что на реальных данных утроение объема модели будет неприемлемым по соображениям производительности).
По той же причине неприемлемо добавлять в таблицу строки с нулевыми продажами, в те даты, когда продажи отсутствуют.
Распространенный метод решения подобных задач – создание в модели двух дополнительных таблиц
•	Календарь, с уникальным индексом по дате.
•	Промежуточная таблица по типу Bridge table, в которой прописываются связи конкретных дат друг с другом, и тип этих связей (в данном примере связь фактической даты с той же датой в предыдущем годе, связь с той же датой предыдущего месяца).
В дальнейшем отчеты строятся на основе этой модели.
В данном конкретном примере при создании промежуточной таблицы окажется, что количество строк в календаре превысит количество строк в исходной главной таблице с данными, это нестрашно, тут мы только моделируем ситуацию. В реальных ситуациях в исходной таблице данных будет намного больше.
В сопутствующем файле Excel на отдельных вкладках находятся исходные данные и примеры (несколько первых строк) отчетов по дням и по месяцам. 
В качестве результата ожидается описание решения, скрипты по созданию таблиц аналитической модели, запросы на получения отчетов в разрезе дней и месяцев, и сами отчеты, которые были получены на базе этих запросов, в формате Excel




